# Process a DC02D file from the BoM.
# Sparate a row of 48 half-hourly values into 48 timestamped rows.

# eg:
# dc, 15590,2015,01,01, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,0.0013490, 0.015029,0.0032100, 0.129977,0.0085830, 0.336487,0.0170970, 0.558668,0.0228870, 0.788860,0.0263640, 1.013373,0.0283250, 1.219802,0.0296800, 1.414199,0.0314040, 1.591431,0.0336270, 1.742194,0.0360060, 1.872012,0.0383840, 1.965598,0.0402140, 2.026407,0.0414410, 2.058733,0.0420970, 2.007221,0.0517770, 2.070352,0.0526950, 2.021605,0.0523200, 1.147442,0.0440560, 1.323737,0.0518940, 1.153309,0.0387030, 0.356455,0.0085050, 0.523801,0.0203860, 0.401106,0.0140040, 0.289265,0.0102630, 0.219562,0.0096130, 0.312589,0.0172770, 0.108893,0.0075680, 0.014072,0.0031570, 0.000190,0.0010560, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,#

BEGIN { FS="," }

# Skip header row
NR == 1 { next } 

# Extract 2015 values only
/,2015,/ { for (i = 0; i < 48; i++) { printf("%s,%s,%s,%02d,%02d,", $3, $4, $5, i / 2, 30 * (i%2)); print $(6 + i*2); } }
